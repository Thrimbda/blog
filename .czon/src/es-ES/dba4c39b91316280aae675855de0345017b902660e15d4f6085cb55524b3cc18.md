---
"title": "Primera aproximación a la concurrencia"
"summary": "Este artículo describe la experiencia del autor al adentrarse en la programación concurrente a través de una pequeña tarea, implementando un demo simple de control concurrente utilizando los módulos queue, signal y time de Python. Se explica la función de los tres módulos: queue actúa como cola de mensajes, signal se usa para capturar la señal KeyboardInterrupt, y time permite que el hilo principal detecte la interrupción. El autor profundiza en la importancia de las colas de mensajes en programación multihilo, así como en la idea de que el diseño de sistemas debe encapsular detalles y utilizar eventos para la colaboración entre componentes, reduciendo así el acoplamiento. Se enfatiza el concepto de 'diseñar para el cambio'."
"tags":
  - "python"
  - "concurrencia"
  - "multihilo"
  - "cola de mensajes"
  - "diseño de sistemas"
"date": "2017-05-07"
---

---
title: Primera aproximación a la concurrencia
date: 2017-05-07
taxonomies:
  tags:
    - python
    - concurrencia
---

Muy bien, una pequeña tarea reciente me dio la oportunidad de adentrarme en la programación concurrente con un propósito real.

<!--more-->

## Demo

Así que creé un pequeño demo ilustrativo, que no es verdaderamente multihilo, utilizando los módulos `queue`, `signal` y `time` de Python:

```python
# -*- coding: utf-8 -*-
# @Author: Michale
# @Date:   2017-05-04 15:00:41
# @Last Modified by:   Michale
# @Last Modified time: 2017-05-07 00:46:52
import signal
import queue
import time


class TestClass(object):
    queue = queue.Queue()

    def __init__(self):
        signal.signal(signal.SIGINT, self.stopIfPressKill)

    def stopIfPressKill(self, mySignal, stack):
        if mySignal == signal.SIGINT:
            print('you pressed CTRL-C')
            self.queue.put_nowait('stop')
            print(self.queue.qsize())

    def mainThread(self):
        while True:
            time.sleep(1)
            if not self.queue.empty():
                data = self.queue.get()
                print(data)
                if data == 'stop':
                    break
                else:
                    self.queue.put(data)


if __name__ == '__main__':
    yoo = TestClass()
    yoo.mainThread()

```

Explicación de la función de los tres módulos:

- `queue`: Actúa como una cola de mensajes, aunque aquí parece un uso excesivo para su capacidad.
- `signal`: Se utiliza para capturar `KeyboardInterrupt` y luego colocar la señal de parada en la cola de mensajes.
- `time`: Permite que el hilo principal pueda detectar este `KeyboardInterrupt`.

## Concepto

La introducción de la programación multihilo hace que los hilos no principales sean difíciles de controlar una vez iniciados, lo que obliga a utilizar métodos como las colas de mensajes para la comunicación entre hilos.

Pero, en realidad, independientemente de si se trata de multihilo o no, los diferentes módulos de un sistema deberían encapsular sus detalles internos y utilizar eventos para colaborar entre sí. Esto ayuda enormemente a reducir el acoplamiento del sistema, y es un principio de diseño fundamental para un buen sistema: **diseñar para el cambio.**