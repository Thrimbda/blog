---
"title": "RBACの概念とシステム設計"
"summary": "本稿では、ロールベースアクセス制御（RBAC）モデルについて詳細に説明します。主体、ロール、権限、セッションなどのオブジェクトとそれらの多対多の関係を含む中核概念を解説します。RBACは強制アクセス制御（MAC）モデルの一種であり、システム管理者がユーザーのロールを一元的に管理すること、またセッション期間中、主体は一つのロールの権限のみを行使できることを強調しています。さらに、RBACの適用シナリオについて考察し、リソースがシステム全体で共有され、階層的なロールを持つシステム（例：企業、最小権限の原則に従うオペレーティングシステム）に適していることを指摘します。同時に、自由裁量アクセス制御（DAC）モデルと比較し、リソースが個人によって所有されるシステム（例：ソーシャルネットワーク）ではDACがより適切であること、また実際のアプリケーションでは両モデルが混合して使用されることが多いことに言及しています。"
"tags":
  - "システム設計と分析"
  - "RBAC"
  - "アクセス制御"
  - "MAC"
  - "DAC"
  - "権限管理"
  - "ロールモデル"
  - "セキュリティモデル"
"date": "2017-05-07"
---

---
title: RBACの概念とシステム設計
date: 2017-05-07
taxonomies:
  tags:
    - システム設計と分析
    - RBAC
---

![RBACmodel](http://0xc1.space/images/2017/05/07/RBACmodel.png)

## RBAC の概念

RBAC (**R**ole-**B**ased **A**ccess **C**ontrol) ロールベースアクセス制御モデルは、強制アクセス制御および自由裁量アクセス制御よりも中立的で柔軟性の高いアクセス制御技術です。

まず、RBACにおけるいくつかのオブジェクトを以下に示します：

- S = 主体 (Subject) = ユーザーまたは自動エージェント
- R = ロール (Role) = 承認レベルとして定義される職位または職称
- P = 権限 (Permission) = リソースへのアクセス方法
- SE = セッション (Session) = S、R、P間のマッピング関係
- SA = 主体割り当て (Subject Assignment)
- PA = 権限割り当て (Permission Assignment)
- RH = ロール階層 (Role Hierarchy)。≥（x ≥ y は x が y の権限を継承することを表す）と表現できます。

次に、各オブジェクト間には以下の関係があります：

- **主体**と**ロール**は多対多の関係です。

  ${\displaystyle SA\subseteq S\times R}$

- **ロール**と**権限**は多対多の関係です。

  ${\displaystyle PA\subseteq P\times R}$

<!--more-->

## RBACについての理解

RBACの関連概念を理解した上で、ここで私の理解を述べたいと思います。

RBACはMAC (**M**andatory **A**ccess **C**ontrol)、つまりシステム管理者がユーザーのロールを一元的に設定・管理するモデルです。

**S**（主体）、**R**（ロール）、**SE**（セッション）の関係は上図の通りです。つまり、一つの主体が複数のロールを持つことができますが、主体がシステムにログインした後（つまりシステムとの一つのセッション期間中）は、一つのロールの権限のみを行使できます。

一方、**P**（権限）はシステムが提供するサービスによって決定され、実際にはシステムが提供するリソースとそのリソースに対して行う操作の組み合わせです。まさにこのリソースと操作の組み合わせによって、権限という概念に意味が生まれます。

### 適用

私が考えるRBACの適用シナリオの定義は以下の通りです：**リソースがシステム全体で共有され、かつ複数の階層化されたロールを持つ、責任分離がなされたシステム**。

リソースがシステム全体で共有され、複数の階層化されたロールを持つということは、システム内のリソースが各ロールにとって異なる意味を持つことを示しており、したがって各ロールがリソースに対して負う責任も異なります。このようなシステムにおいて、RBACは非常に適切なアクセス制御モデルであり、権利と責任を効果的に割り当て、システム内のリソースをより良く保護・活用することができます。

例：企業、および最小権限の原則 (Principle of least privilege) に従うオペレーティングシステム。

一方、リソースが個人によって所有されるシステムでは、各ロールは平等であり、各ロールは自身のリソースに対して完全な制御権を持ちます。この場合、RBACモデルは力不足であり、DAC (**D**iscretionary **A**ccess **C**ontrol) モデルを使用すべきです。これはソーシャルネットワークシステムで非常に一般的です。

実際のシナリオでは、純粋に共有されるリソースと純粋に独占されるリソースが存在することはあり得ないため、多くの場合、これら2つのモデルを混合して使用します。例：WeChat（微信）では、一般ユーザーは自身の「リソース」（友達の輪）に対して完全な管理権限を持ちます。しかし、一般ユーザーは他のユーザーを管理することはできず、「通報」機能の実現は、システム内のより高い権限を持つ他のロールによる介入に依存しています。