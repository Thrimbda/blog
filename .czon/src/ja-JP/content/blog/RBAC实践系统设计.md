---
"title": "RBACの概念とシステム設計"
"summary": "本稿では、RBAC（ロールベースアクセス制御）モデルの核心概念について詳細に説明します。主体、ロール、権限、セッションなどのオブジェクトとそれらの多対多の関係を含みます。本稿は、RBACが強制アクセス制御モデルとして、システム管理者がユーザーロールを一元的に管理するものであることを説明し、セッション期間中、主体は一つのロールの権限のみを行使できることを強調しています。著者はさらに、RBACの適用シナリオ、すなわちリソースがシステムで共有され、複数の階層化されたロールを持つシステム（商業会社や最小権限の原則に従うオペレーティングシステムなど）について考察しています。同時に、DAC（随意アクセス制御）モデルと比較し、リソースが個人によって所有されるシステムではDACがより適切であることを指摘し、実際のシナリオでは両モデルを混合して使用することを提案しています。最後に、WeChatを例として混合モデルの実際の応用を説明しています。"
"tags":
  - "RBAC"
  - "システム設計"
  - "アクセス制御"
  - "権限管理"
  - "MAC"
  - "DAC"
  - "ロール"
  - "最小権限の原則"
"date": "2017-05-07"
---

---
title: RBACの概念とシステム設計
date: 2017-05-07
taxonomies:
  tags:
    - システム設計と分析
    - RBAC
---

![RBACmodel](http://0xc1.space/images/2017/05/07/RBACmodel.png)

## RBAC の概念

RBAC (**R**ole-**B**ased **A**ccess **C**ontrol) ロールベースアクセス制御モデルは、強制アクセス制御や随意アクセス制御よりも中立的で柔軟性の高いアクセス制御技術です。

まず、RBACにおけるいくつかのオブジェクトを示します：

- S = 主体 (Subject) = ユーザーまたは自動エージェント
- R = ロール (Role) = 承認レベルとして定義される職務または職位
- P = 権限 (Permission) = リソースへのアクセス方法
- SE = セッション (Session) = S、R、P間のマッピング関係
- SA = 主体割り当て (Subject Assignment)
- PA = 権限割り当て (Permission Assignment)
- RH = ロール階層 (Role Hierarchy)。≥（x ≥ y は x が y の権限を継承することを表す）として表現可能

次に、各オブジェクト間には以下の関係があります：

- **主体**と**ロール**は多対多の関係です。

  ${\displaystyle SA\subseteq S\times R}$

- **ロール**と**権限**は多対多の関係です。

  ${\displaystyle PA\subseteq P\times R}$

<!--more-->

## RBACについての理解

RBACの関連概念を理解した後、ここで私の理解を述べます。

RBACはMAC (**M**andatory **A**ccess **C**ontrol) の一種であり、システム管理者が各ユーザーのロールを一元的に設定・管理します。

**S**（主体）、**R**（ロール）、**SE**（セッション）の関係は上図の通りです。つまり、一つの主体が複数のロールを持つことができますが、主体がシステムにログインした後（つまりシステムとの一つのセッション期間中）は、一つのロールの権限のみを行使できます。

一方、**P**（権限）はシステムが提供するサービスによって決定され、実際にはシステムが提供するリソースとそのリソースに対して行う操作の組み合わせです。まさにこのリソースと操作の組み合わせによって、権限という概念に意味が生まれます。

### 応用

私が考えるRBACの適用シナリオは、**リソースがシステムで共有され、複数の階層化されたロールによる責任分離がなされているシステム**です。

リソースがシステムで共有され、複数の階層化されたロールが存在することは、システム内のリソースが各ロールにとって異なる意味を持つことを示しており、したがって各ロールがリソースに対して負う責任も異なります。このようなシステムにおいて、RBACは権利と責任を効果的に割り当て、システム内のリソースをより良く保護・活用するための非常に適切なアクセス制御モデルです。

例：商業会社、および最小権限の原則 (Principle of least privilege) に従うオペレーティングシステム。

一方、リソースが個人によって所有されるシステムでは、各ロールは平等であり、各ロールは自身のリソースに対して完全な制御権を持ちます。この場合、RBACモデルは力不足であり、DAC (**D**iscretionary **A**ccess **C**ontrol) モデルを使用すべきです。これはソーシャルネットワークシステムで非常に一般的です。

実際のシナリオでは、純粋に共有されるリソースと純粋に独占されるリソースが存在することはあり得ないため、多くの場合、これら2つのモデルを混合して使用します。例：WeChatでは、一般ユーザーは自身の「リソース」（友達の投稿）に対して完全な管理権限を持ちます。しかし、一般ユーザーは他のユーザーを管理することはできず、「通報」という機能の実現は、システム内のより高い権限を持つ他のロールによる介入に依存しています。