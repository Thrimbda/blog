---
"title": "RBACの概念とシステム設計"
"summary": "本稿では、ロールベースアクセス制御（RBAC）モデルについて詳細に説明します。主体、ロール、権限、セッションなどのコア概念と、それらの多対多の関係を含みます。RBACは、システム管理者がユーザーのロールを一元的に管理する強制アクセス制御（MAC）モデルとして説明され、セッション期間中、主体は一つのロールの権限のみを行使できる点が強調されています。さらに、RBACの適用シナリオについて考察し、商業会社や最小権限の原則に従うオペレーティングシステムなど、リソースがシステムで共有され、階層的なロールを持つシステムに適していることを指摘します。同時に、自由裁量アクセス制御（DAC）モデルと比較し、リソースが個人によって所有されるシステム（ソーシャルネットワークなど）ではDACがより適切であること、また実際のアプリケーションでは両モデルが混合して使用されることが多いことに言及しています。"
"tags":
  - "システム設計と分析"
  - "RBAC"
  - "アクセス制御"
  - "MAC"
  - "DAC"
  - "権限管理"
  - "ロールモデル"
  - "セキュリティモデル"
"date": "2017-05-07"
---

---
title: RBACの概念とシステム設計
date: 2017-05-07
taxonomies:
  tags:
    - システム設計と分析
    - RBAC
---

![RBACmodel](http://0xc1.space/images/2017/05/07/RBACmodel.png)

## RBAC の概念

RBAC (**R**ole-**B**ased **A**ccess **C**ontrol) ロールベースアクセス制御モデルは、強制アクセス制御および自由裁量アクセス制御よりも中立的で柔軟性の高いアクセス制御技術です。

まず、RBACにおけるいくつかのオブジェクトを示します：

- S = 主体 (Subject) = ユーザーまたは自動エージェント
- R = ロール (Role) = 承認レベルとして定義される職務または職位
- P = 権限 (Permission) = リソースへのアクセス方法
- SE = セッション (Session) = S、R、P間のマッピング関係
- SA = 主体割り当て (Subject Assignment)
- PA = 権限割り当て (Permission Assignment)
- RH = ロール階層 (Role Hierarchy)。≥（x ≥ y は x が y の権限を継承することを表す）として表現可能

次に、各オブジェクト間には以下の関係があります：

- **主体**と**ロール**は多対多の関係です。

  ${\displaystyle SA\subseteq S\times R}$

- **ロール**と**権限**は多対多の関係です。

  ${\displaystyle PA\subseteq P\times R}$

<!--more-->

## RBACの理解

RBACの関連概念を理解した後、ここで私の理解について述べます。

RBACは、システム管理者が各ユーザーのロールを一元的に設定・管理するMAC (**M**andatory **A**ccess **C**ontrol) の一種です。

**S**（主体）、**R**（ロール）、**SE**（セッション）の関係は上図の通りです。つまり、一つの主体が複数のロールを持つことができますが、主体がシステムにログインした後（つまりシステムとの一つのセッション期間中）は、一つのロールの権限のみを行使できます。

一方、**P**（権限）はシステムが提供するサービスによって決定され、実質的にはシステムが提供するリソースと、そのリソースに対して行われる操作の組み合わせです。まさにこのリソースと操作の組み合わせによって、権限という概念に意味が生まれます。

### 適用

私が考えるRBACの適用シナリオの定義は、**「リソースがシステムによって共有され、複数の階層化されたロールを持つ、責任分離がなされたシステム」**です。

リソースがシステムによって共有され、複数の階層化されたロールを持つということは、システム内のリソースが各ロールにとって異なる意味を持つことを示しており、したがって各ロールがリソースに対して負う責任も異なります。このようなシステムにおいて、RBACは非常に適切なアクセス制御モデルであり、権利と責任を効果的に割り当て、システム内のリソースをより良く保護・活用することができます。

例：商業会社、および最小権限の原則 (Principle of least privilege) に従うオペレーティングシステム。

一方、リソースが個人によって所有されるシステムでは、各ロールは平等であり、各ロールは自身のリソースに対して完全な管理権限を持ちます。この場合、RBACモデルは力不足であり、DAC (**D**iscretionary **A**ccess **C**ontrol) モデルを使用すべきです。これはソーシャルネットワークシステムで非常に一般的です。

実際のシナリオでは、純粋な共有リソースと純粋な専有リソースが存在することはあり得ないため、これら2つのモデルを混合して使用することがよくあります。例：WeChat（微信）では、一般ユーザーは自身の「リソース」（友達の輪）に対して完全な管理権限を持ちます。しかし、一般ユーザーは他のユーザーを管理することはできず、「通報」機能の実現は、システム内のより高い権限を持つ他のロールによる介入に依存しています。