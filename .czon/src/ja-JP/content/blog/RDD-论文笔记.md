---
"title": "RDD 論文ノート"
"summary": "本稿は、Resilient Distributed Datasets (RDDs) に関する論文のノートであり、RDDの設計動機、中核概念、および利点を分析しています。RDDは、分散メモリ抽象化として、不変性と遅延評価の特性を通じて、transformationとactionの操作をサポートし、DAGを用いて依存関係を表現します。細粒度な操作を犠牲にすることで、耐障害性、汎用性、および性能を実現し、反復計算においてHadoopと比較して顕著な向上（例：20-40倍）を示しています。また、Sparkの実装と評価結果の概要を述べ、RDDが粗粒度な計算には適しているが、細粒度な非同期タスクには適さないことを指摘しています。"
"tags":
  - "RDD"
  - "Spark"
  - "分散システム"
  - "論文ノート"
  - "メモリ抽象化"
  - "反復計算"
  - "耐障害性"
"date": "2020年10月29日"
---

Resilient Distributed Datasets (RDDs) は、分散システムに対するメモリ抽象化そのものです。

本質的には、制限の厳しい**共有メモリ**モデルであり、粗粒度な transformation 操作のみを提供します。

## 動機

### 問題

反復的（iterative）な分散計算には、（効率的な）反復間でのデータ再利用能力が必要です。

### 現状

- 当時（2012年）存在していた分散計算フレームワークには、クラスタメモリを十分に活用（再利用）できる抽象化が欠けていました。
- 既存のフレームワークでデータを再利用する唯一の方法は、複数回の分散計算を起動することでした。

したがって、問題が原理的に解けることは保証されていても、データの再利用は依然としてこの種の計算における性能上のボトルネックでした。過度に頻繁なI/Oによって大量のリソースが浪費されていたのです。

これらの問題を解決しようとする研究はいくつかありましたが、特定の計算パターンしかサポートできず、十分に汎用的ではありませんでした。

主な課題は、計算の細粒度性、汎用性、および耐障害性という3つの要素の間でのトレードオフにありました。

## RDD

RDDは、分散計算クラスタに対するメモリ抽象化を提供し、上記の問題を大きく解決しました。その手法は、3つの要素の中で相対的に最も重要度の低い「計算の粒度」を犠牲にするというものです。

### 基本

RDDの特性：

- 不変（Immutable）
- 遅延評価（Lazy）

RDDがサポートする操作：

- transformation - 遅延操作（Lazy operations）
  - map
  - filter
  - ...
- action - 計算の起動（Launch computations）
  - count
  - collect
  - save
  - ...
- persist（キャッシュ）

SparkはRDDを実装し、DryadLINQに似たプログラミングインターフェースを提供しています。

### RDDの利点

主に、（クラスタメモリをモデル化する）類似の抽象化と比較して、RDDは細粒度なデータ操作を犠牲にすることで、他の側面（汎用性、耐障害性、性能低下時の挙動、一貫性、ストラグラー問題、使いやすさ）において圧倒的な優位性を実現しています。

### RDDの制限

RDDは、大量の細粒度な読み書きを伴う非同期計算（例えば、クローラのストレージシステム）には適していません。このようなアプリケーションに対して、著者は他のフレームワークを提案していますが、ここでは詳述しません。

## Sparkのプログラミングインターフェース

Scalaで実装されています。その理由は、Scalaが簡潔で効率的であるためです。

この部分では著者がいくつかの例を挙げていますが、ここでは省略します。

## RDDの表現

RDDを表現するためにDAGを使用します。

### 依存関係

- 狭い依存関係（narrow dependencies） - 各親RDDは、最大でも1つの子RDDに依存されます。
- 広い依存関係（Wide dependencies） - 1つの親RDDが、少なくとも1つの子RDDに依存されます。

## 実装

- クラスタ管理にはMesosを使用
- ジョブスケジューリングは省略
- インタープリタ統合は省略
- メモリ管理は省略

## 評価

- 反復的タスクにおいて、Hadoopの20倍の性能
- ユーザー分析プログラムにおいて、Hadoopの40倍の性能を報告
- ノード障害後、迅速に再計算可能
- 1TBのデータに対するクエリの遅延は5-7秒

詳細は省略します。

## 考察

彼らは、RDDの汎用性を示すために、他の分散計算フレームワークを模倣するという非常に意欲的な方法でSparkを使用しました。

具体的な内容は省略します。

## まとめ

- RDD/Sparkの最大の利点は、クラスタ全体のメモリをモデル化することにあり、分散計算が中間結果をメモリ内に保存できるようにします。これにより、同一のDatasetに対する高速な連続計算が可能になります。このすべては、メモリがハードディスクよりも一桁速いという前提に基づいています（それゆえに、SparkがHadoopに対して40倍の性能向上を実現できたのです）。
  ソフトウェア革新の理論的限界は、ハードウェアの物理的制約によって決まるということがわかります。