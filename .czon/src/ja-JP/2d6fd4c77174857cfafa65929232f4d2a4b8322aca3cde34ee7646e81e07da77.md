---
"title": "RBACの概念とシステム設計"
"summary": "本稿では、ロールベースアクセス制御（RBAC）モデルについて詳細に解説します。主体、ロール、権限、セッションなどのコア概念とそれらの多対多関係を含みます。RBACは、中立的で柔軟なアクセス制御技術として、リソースが共有されロールが階層化されたシステム（例：企業、最小権限の原則に従うオペレーティングシステム）に適しています。また、著者はRBACと強制アクセス制御（MAC）および任意アクセス制御（DAC）の違いを比較し、実際のアプリケーションではこれらのモデルが混合して使用されることが多く、WeChatを例に混合シナリオを説明しています。さらに、RBACの適用限界についても議論し、個人リソースシステムにおけるその限界性を強調しています。"
"tags":
  - "システム設計と分析"
  - "RBAC"
  - "アクセス制御"
  - "MAC"
  - "DAC"
  - "権限管理"
  - "ロールモデル"
  - "セキュリティモデル"
"date": "2017-05-07"
---

---
title: RBACの概念とシステム設計
date: 2017-05-07
taxonomies:
  tags:
    - システム設計と分析
    - RBAC
---

![RBACmodel](http://0xc1.space/images/2017/05/07/RBACmodel.png)

## RBAC の概念

RBAC (**R**ole-**B**ased **A**ccess **C**ontrol) ロールベースアクセス制御モデルは、強制アクセス制御および任意アクセス制御よりも中立的で柔軟性の高いアクセス制御技術です。

まず、RBACにおけるいくつかのオブジェクトを説明します：

- S = 主体 (Subject) = ユーザーまたは自動エージェント
- R = ロール (Role) = 承認レベルとして定義される職位または職称
- P = 権限 (Permission) = リソースへのアクセス方法
- SE = セッション (Session) = S、R、P間のマッピング関係
- SA = 主体割り当て (Subject Assignment)
- PA = 権限割り当て (Permission Assignment)
- RH = ロール階層 (Role Hierarchy)。≥（x ≥ y は x が y の権限を継承することを表す）と表現できます。

次に、各オブジェクト間には以下の関係があります：

- **主体**と**ロール**は多対多の関係です。

  ${\displaystyle SA\subseteq S\times R}$

- **ロール**と**権限**は多対多の関係です。

  ${\displaystyle PA\subseteq P\times R}$


<!--more-->

## RBACについての理解

RBACの関連概念を理解した上で、ここで私の理解を述べたいと思います。

RBACは、MAC (**M**andatory **A**ccess **C**ontrol) の一種であり、システム管理者が各ユーザーロールを一元的に設定・管理します。

**S**（主体）、**R**（ロール）、**SE**（セッション）の関係は上図の通りです。つまり、一つの主体が複数のロールを持つことができますが、主体がシステムにログインした後（つまり、システムとの一つのセッション期間中）は、一つのロールの権限しか行使できません。

一方、**P**（権限）はシステムが提供するサービスによって決定され、実際にはシステムが提供するリソースとそのリソースに対する操作の組み合わせです。まさにこのリソースと操作の組み合わせによって、権限という概念に意味が生まれます。



### 適用

私が考えるRBACの適用シナリオの定義は次の通りです：**リソースがシステムによって共有され、かつ、多様で階層化されたロールによる責任分離がなされているシステム**。

リソースがシステムによって共有され、多様で階層化されたロールが存在するということは、システム内のリソースが各ロールにとって異なる意味を持つことを示しており、したがって各ロールがリソースに対して負う責任も異なります。このようなシステムにとって、RBACは権利と責任を効果的に割り当て、システム内のリソースをより適切に保護・活用するための非常に適切なアクセス制御モデルです。

例：企業、および最小権限の原則 (Principle of least privilege) に従うオペレーティングシステム。



一方、リソースが個人によって所有されているシステムでは、すべてのロールが平等であり、各ロールは自身のリソースに対して完全な管理権限を持ちます。この場合、RBACモデルは力不足であり、DAC (**D**iscretionary **A**ccess **C**ontrol) モデルを使用すべきです。これはソーシャルネットワークシステムで非常に一般的です。

実際のシナリオでは、純粋に共有されたリソースと純粋に個人所有のリソースが存在することはあり得ないため、これら2つのモデルを混合して使用することがよくあります。例：WeChatでは、一般ユーザーは自身の「リソース」（友達の投稿）に対して完全な管理権限を持ちます。しかし、一般ユーザーは他のユーザーを管理することはできず、「通報」機能の実現には、より高い権限を持つ他のロールによる介入が依存しています。