---
"title": "Zolaブログのリアルタイム編集とバックエンド設計案"
"summary": "このドキュメントでは、Zolaブログサイトの現状（技術スタック、デザイン言語、コンテンツ特性）を詳細に分析し、WYSIWYG Markdownリアルタイム編集機能の実現に向けた設計案を提案します。コアとして、Vditorをエディター、Supabaseをバックエンドのストレージおよび認証ソリューションとして使用することを推奨し、ビルドチェーンの導入を不要とし、既存の極小JSスタイルとsuCSSデザイン言語を維持することを強調します。また、編集範囲、公開フローなどの重要な決定ポイントを検討し、エディターとバックエンドの代替案を提供することで、提案が既存プロジェクトに適合し、実装が容易であることを保証します。"
"tags":
  - "Zola"
  - "Markdown"
  - "WYSIWYG"
  - "Supabase"
  - "リアルタイム編集"
  - "ブログ"
  - "フロントエンド"
  - "デザイン"
"date": "2026-01-06"
---

# Zola ブログ：WYSIWYG Markdown リアルタイム編集 + Supabase/GitHub バックエンド設計案 - コンテキスト

## セッション進捗 (2026-01-06)

### ✅ 完了済み

- 現状の予備監査：プロジェクトはZolaサイトで、テーマはanemone + suCSSを基盤とし、現在JSは極めて少なくCDN依存が許容されています。

### 🟡 進行中

- レビュー可能な詳細設計（エディター/バックエンド選定 + 公開/同期フロー + 実装手順）の作成。

### ⚠️ ブロッキング/未決定事項

- 「リアルタイム編集」の正確な意味（リアルタイムプレビュー vs 自動保存 vs マルチユーザー協調編集）。
- 編集範囲（少数のページ/単一ファイルのみ編集か、サイト全体のコンテンツ編集か）。
- 公開フロー（下書き保存のみか、`content/` ディレクトリに同期してZolaビルドをトリガーするか）。

---

## 主要ファイル

- `config.toml`：サイト設定とナビゲーション。デフォルトテーマはライトで、多言語対応。
- `templates/head.html`：サイト全体で `static/css/reset.css`、`static/css/suCSS.css`、`static/css/style.css`、`static/js/script.js` を読み込み、CDN経由で `rxjs`、`highlight.js`、`mermaid` を導入。
- `static/css/suCSS.css`：デザイントークン（CSS変数）と基本コンポーネントスタイル（フォーム、ボタン、テーブル等）。ライト/ダークテーマ変数を含む。
- `static/css/style.css`：サイトカスタムスタイル（ナビゲーション、フッター、スライダー、ショートコードスタイル等）。
- `static/js/script.js`：テーマ切替（`data-theme` + localStorage）とスライダー操作。管理ページに再利用可能で、一貫した体験を維持。
- `content/**`：Markdownコンテンツソース。YAML front matter（`---`）とショートコード（例：`{{ slideshow(...) }}`）を含む。

---

## 主要決定事項

| 決定事項 | 理由 | 代替案 | 日付 |
|------|------|----------|------|
| デフォルト推奨「純JS管理ページ + Supabase ストレージ/認証」、エディターはVditorを優先評価 | 現在のプロジェクトにNode/Reactビルドチェーンなし。既存のCDN依存慣例あり。VditorはWYSIWYG/IR/SV三モードと「ブラウザサイドMarkdownエディター」の位置付けで、統合コストが最低。 | React + shadcn + Milkdown/TipTap。またはGitHub Discussion/Issueをバックエンドとして使用。 | 2026-01-06 |

---

## 現状監査要約

### 技術スタック/デプロイ

- サイトはZola（`config.toml`）で構築。GitHub Actionsは `shalzz/zola-deploy-action` を使用して `gh-pages` にデプロイ（`.github/workflows/*.yaml`）。
- サイトは「極小JS」志向：現在の全サイトスクリプトは `static/js/script.js` のみで、他はCDN（`rxjs`、`highlight.js`、`mermaid`）。

### テーマとデザイン言語（維持必須）

- ビジュアルは `suCSS.css` のCSS変数に基づく：`--bg/--bg-light/--text/--text-light/--accent/--accent-light/--link/--border` 等。
- テーマ切替機構：`document.documentElement[data-theme="light"|"dark"]` を `prefers-color-scheme` + localStorageと同期（`static/js/script.js` 参照）。
- コンポーネントスタイル：ボタン/フォーム/テーブル/リストマーカー等は全て `suCSS.css` で定義。新規UIは、新しいデザインシステムを導入するのではなく、これらのセマンティック要素と変数を優先的に再利用すべき。

### コンテンツ特性（エディターに影響）

- Markdownは以下を含む可能性あり：
  - YAML front matter（例：`content/gcores-talks.md`）
  - Zolaショートコード（例：`{{ slideshow(...) }}`、テンプレートは `templates/shortcodes/*` に配置）
  - ハイライトコードブロック、mermaidコードブロック
- リスクポイント：WYSIWYGエディターがショートコードを「理解/レンダリング」しようとすると、原文を書き換えたり消失させたりする可能性あり。「未知の構文をそのまま保持」するエディター/モードを選択するか、エディター内に「ソースモード」をフォールバックとして提供する必要がある。

---

## エディター調査（ウェブ + 資料）

> 目標：埋め込み可能、WYSIWYG（リッチテキスト/見たまま編集）をサポートし、Markdownを出力可能。ビルドチェーン不要（純JS/CDN）が望ましい。

| 候補 | 位置付け/モード | 統合形態 | テーマ/カスタマイズ | キーポイント | 本プロジェクトへの適合性結論 |
|---|---|---|---|---|---|
| **Vditor** | ブラウザサイドMarkdownエディター。WYSIWYG/IR(Typora風)/SV分割表示をサポート | ネイティブJS。公式サイトとCDN形態が成熟（ページ文言で三モードを明確に強調） | 組み込みテーマと設定項目が多い。CSS変数でsuCSSに近づけることが可能 | リアルタイム保存、貼り付け/ドラッグ&ドロップアップロード等の機能をサポート（公式サイトページ説明参照）。MITライセンス（`https://unpkg.com/vditor@3.10.4/LICENSE`） | **最優先推奨**：「ビルドチェーンなし + リアルタイム編集」との適合度が最高。「ショートコード/Front matterが破壊されない」ことを重点検証する必要あり |
| **TOAST UI Editor** | Markdown/WYSIWYG デュアルモード | CDN（`uicdn.toast.com/editor/latest/...`）またはnpm | テーマ/スタイル体系あり。カスタムCSSで適合可能 | ドキュメントでCDNサポートと `usageStatistics` 無効化を明確に記載（`https://unpkg.com/@toast-ui/editor@3.2.2/README.md`） | 代替候補：成熟しているがスタイル体系がより「重い」。suCSSへのテーマ適合コストが高い可能性あり。ライセンスは統合時に再確認が必要 |
| **Milkdown** | プラグイン化WYSIWYG Markdownエディター（Typora風）、ProseMirror + remark | 通常バンドラー（React/Vue等）が必要 | 深いカスタマイズ可能だが、エンジニアリングコストが高い | READMEでWYSIWYG Markdownエディターの位置付けとMITライセンスを明確に記載（`https://raw.githubusercontent.com/Milkdown/milkdown/main/README.md`） | 「React/shadcnを導入する」場合の候補として適切。現在のZolaプロジェクトとは適合せず（ビルドチェーン導入が必要） |
| **TipTap** | リッチテキストエディターツールキット（HTML/Schema志向が強い） | React/Vue/Svelte等 | カスタマイズ性が高いが、Markdownは追加の変換と制約が必要なことが多い | 公式サイトで「リアルタイム協調編集」等を強調するが、Markdownファーストは中核ではない | 第一選択としては非推奨（Markdownとショートコードのシナリオが複雑） |

---

## バックエンド調査（バックエンド手書き不要）

| 案 | 自前サービス構築が必要か | 認証/権限 | ストレージ/履歴 | Zola公開との関係 | 結論 |
|---|---|---|---|---|---|
| **Supabase** | 不要（DB/Auth/Storageをホスト） | フロントエンド直結 + RLS。匿名キーは公開可能 | DB行レベル履歴は自前構築が必要（リビジョンテーブル作成可能） | サイトに影響を与えるには「リポジトリ/content に同期」する必要あり | **デフォルト推奨**：実装が最も直接的。セキュリティ境界が明確（RLS）。画像ストレージも容易 |
| **GitHub Issue/Discussion** | 理論上サービス不要だが、実際にはOAuthトークン交換サービスが必要なことが多い | OAuthフローが複雑（純フロントエンドではトークン交換を安全に処理するのが困難） | GitHubは自然に履歴/監査機能あり | サイトに同期するには、issue/discussionを `content/` に変換するスクリプトが必要 | 代替案：「コンテンツをGitHubデータとして強く希望する」場合に検討可能。ただし認証/アップロード/同期の複雑さが高い |

補足：GitHub DocsのOAuth web flowでは、「codeをaccess tokenと交換する」ステップで `client_id` と `client_secret` の両方を同時に提供することを明確に要求しており、これにより「純フロントエンドがGitHubに直接接続して書き込みバックエンドとする」ことはセキュリティ上、成立が難しい（トークン交換サービスを導入するか、device flowなどの制限された案に切り替えない限り）。

---

## クイックハンドオーバー

**次回はここから継続：**

1.  `plan.md` で「リアルタイム編集/編集範囲/公開フロー」のデフォルト仮定と、レビューが必要な決定ポイントを確認する。
2.  あなたのフィードバックに基づき、三つの案（Supabase / GitHub Discussions / React化）から最終推奨と実装手順を固める。

**注意事項：**

- すべてのUI（管理ページを含む）は、`suCSS.css` のCSS変数とライト/ダーク機構を再利用し、スタイルを破壊する新しいテーマ体系を導入してはならない。
- 重点検証が必要：エディターがZolaショートコードとfront matterを書き換えないか。

---

*最終更新: 2026-01-06 20:30 by Codex*